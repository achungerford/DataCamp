---
title: "ggplot2 Visualizing Data"
output: html_notebook
---

## Setup

```{r}
library(dplyr)
library(ggplot2)
library(readr)
```


## Import data

```{r message=FALSE}
gapminder <- read_tsv("gapminder.tsv", col_names = TRUE)
```


## Subset the Data

When you're working on visualizing only a subset of data its useful to save that data as a new data frame. These examples are working with the data from 2007 so we save that as a new data frame.

```{r}
gapminder_07 <- gapminder %>%
    filter(year == 2007)
```


## Three parts to a ggplot graph

1. the data we're visualizing (gapminder_07)
2. mapping variables in your data to aesthetics in your graph
3. sepcify the type of graph you're creating by adding a geom layer (for example). Geom means you're adding a type of geometeric object to the graph. The point indicates a scatterplot.

Suppose you want to examine the relationship between a country's wealth and its life expectancy. You could put GDP per capita on the x-axis and life expectancy on the y-axis

```{r}
# relationship bewteen a country's wealth and life expectancy for year 2007
ggplot(gapminder_07, aes(x = gdpPercap, y = lifeExp)) +
    geom_point()
```

The probelm with the above plot and some others below is the enormous distribution in scale of the x-axis, with some countries having GDP per capita in the tens of thousands while others are only in the hundreds. When you have a wide distribution like that many observations get crammed into the same area of the plot and can be hard to differentiate. In these graphs, we see it on the left side.


## Log Scales

When you have data with a wide distribution range it's helpful to use a log scale on the axises. A log scale is a scale where each fixed distance represents a multiplication of the value. So a log-base-10 scale means that the second tick mark on the axis represents a 10x increase over the previous one. Think 10...100...1000...1000.

The plot below is the same data, but now each unit on the x-axis represents a change of 10 times the GDP. And we can see the relationship now looks more linear.

```{r}
ggplot(gapminder_07, aes(x = gdpPercap, y = lifeExp)) +
  geom_point() +
  scale_x_log10()
```


## Add Color

Continent is a categorical variable. A good way to represent categorical variables is using color. 

```{r}
# added color
ggplot(gapminder_07, aes(x = gdpPercap, y = lifeExp,
                         color = continent)) +
  geom_point() +
  scale_x_log10()
```


## Add Size

Population is numerical value so a good way to represent it is in the size of the scattterplot points.

```{r}
# including population as size of points
ggplot(gapminder_07, aes(x = gdpPercap, y = lifeExp,
                         color = continent,
                         size = pop)) +
  geom_point() +
  scale_x_log10()
```


## Faceting: Divide Your Plot into Smaller Subplots

The tilde `~` means "by", so, facet by continent.

```{r}
ggplot(gapminder_07, aes(x = gdpPercap, y = lifeExp)) +
  geom_point() +
  scale_x_log10() +
  facet_wrap(~ continent)
```


## 1952 Examples

Filter gapminder for observations from the year 1952, and assign it to a new dataset gapminder_1952.

```{r}
# subset the data
gapminder_1952 <- gapminder %>%
    filter(year == 1952)
```

### Example 1: Y-axis is GDP per capita
#### Population (x-axis) & GDP per capita (y-axis)

```{r}
# population on x-axis, GDP per capita on y-axis
ggplot(gapminder_1952, aes(x = pop, y = gdpPercap)) +
  geom_point()
```


#### Log10 scale for both x-axis & y-axis

```{r}
ggplot(gapminder_1952, aes(x = pop, y = gdpPercap)) +
  geom_point() +
  scale_x_log10() +
  scale_y_log10()
```

### Example 2: Y-axis is Life Expectancy
#### Population (x-axis) & Life Expectancy (y-axis)

```{r}
# pop on the x-axis and lifeExp on the y-axis
ggplot(gapminder_1952, aes(x = pop, y = lifeExp)) + 
    geom_point()
```


#### x-axis on Log10 scale

```{r}
ggplot(gapminder_1952, aes(x = pop, y = lifeExp)) +
  geom_point() +
  scale_x_log10()
```


#### Add Color

```{r}
# including color
ggplot(gapminder_1952, aes(x = pop, y = lifeExp,
                           color = continent)) +
  geom_point() +
  scale_x_log10()
```


#### Add size

```{r}
# including size
ggplot(gapminder_1952, aes(x = pop, y = lifeExp,
                           color = continent,
                           size = gdpPercap)) +
  geom_point() +
  scale_x_log10()
```


#### Facet by Continent

We remove the color aesthetic because all the points in each graph would be the same color and it would add an unncessary legend.

```{r}
# Facet by continent, need to remove color
ggplot(gapminder_1952, aes(x = pop, y = lifeExp)) +
  geom_point() +
  scale_x_log10() +
  facet_wrap(~ continent)
```


#### Facet by Year

Notice that we are no longer using a subset of data such as `gapminder_1952`. We are using the full data set because we're working with data from more than one year.

```{r}
# include color, size, facet by year
ggplot(gapminder, aes(x = gdpPercap, y = lifeExp,
                      color = continent,
                      size = pop)) +
  geom_point() +
  scale_x_log10() +
  facet_wrap(~ year)
```
